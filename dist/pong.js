!function(){"use strict";function t(){this.x=0,this.y=0,this.vx=0,this.vy=0,this.ax=1,this.ay=1,this.width=14,this.height=14,this.halfHeight=this.height/2,this.halfWidth=this.width/2,this.radius=6,this.restitution=2}function i(){}function e(){this.pressedKeys=[],this.keydown=function(t){this.pressedKeys[t.keyCode]=!0},this.keyup=function(t){this.pressedKeys[t.keyCode]=!1},document.addEventListener("keydown",this.keydown.bind(this)),document.addEventListener("keyup",this.keyup.bind(this))}function h(t,i){this.x=t,this.y=i,this.width=10,this.height=80,this.score=0,this.halfWidth=this.width/2,this.halfHeight=this.height/2,this.restitution=1.1}function s(t){this.touches=[],this.touchMoveListener=function(t){},this.doubleTapListener=function(){},this.timeout=0,this.lastTap=0,t.addEventListener("touchstart",function(t){t.preventDefault();for(var i=0;i<t.changedTouches.length;i++){var e=t.changedTouches[i];this.touches[e.identifier]={x:e.clientX,y:e.clientY}}}.bind(this)),t.addEventListener("touchmove",function(t){t.preventDefault(),clearTimeout(this.timeout);for(var i=0;i<t.changedTouches.length;i++){var e=t.changedTouches[i],h=this.touches[e.identifier];this.touches[e.identifier]={x:e.clientX,y:e.clientY};var s={x:e.clientX-h.x,y:e.clientY-h.y};this.touchMoveListener({x:e.clientX,y:e.clientY,offset:s})}}.bind(this)),t.addEventListener("touchend",function(t){event.preventDefault();for(var i=0;i<t.changedTouches.length;i++)delete this.touches[t.changedTouches[i].identifier];var e=(new Date).getTime(),h=e-this.lastTap;clearTimeout(this.timeout),500>h&&h>0?this.doubleTapListener():this.timeout=setTimeout(function(){clearTimeout(this.timeout)},500),this.lastTap=e}.bind(this))}function n(t,i){this.x=t,this.y=i,this.value=0}function o(){var o=this,a=document.getElementById("game");this.width=a.width,this.height=a.height,this.context=a.getContext("2d"),this.context.fillStyle="white",this.keys=new e,this.touches=new s(a),this.collisions=new i,this.keys.addKeyPressListener(u,function(t){o.showMenu(),o.paused?o.paused=!1:o.paused=!0}),this.paused=!0,this.p1=new h(5,0),this.p1.y=this.height/2-this.p1.height/2,this.display1=new n(this.width/4,35),this.p2=new h(this.width-5-10,0),this.p2.y=this.height/2-this.p2.height/2,this.display2=new n(3*this.width/4,35),this.displayPaused=new n(this.width/2-20,this.height/2-10),this.touches.doubleTapListener=function(){o.paused||(o.showMenu(),o.paused=!0)},this.touches.touchMoveListener=function(t){t.x<o.width/2?t.offset.y<0?o.p1.y=Math.max(0,o.p1.y+t.offset.y):o.p1.y=Math.min(o.height-o.p1.height,o.p1.y+t.offset.y):t.x>o.width/2&&(t.offset.y<0?o.p2.y=Math.max(0,o.p2.y+t.offset.y):o.p2.y=Math.min(o.height-o.p2.height,o.p2.y+t.offset.y))},this.ball=new t,this.ball.x=this.width/2,this.ball.y=this.height/2,this.ball.vy=Math.floor(Math.random()*c-p),this.ball.vx=c-Math.abs(this.ball.vy)}function a(t){g=requestAnimationFrame(a),y.update(),y.inputs(),y.draw()}function d(){var t=Math.max(document.documentElement.clientWidth,window.innerWidth||0),i=Math.max(document.documentElement.clientHeight,window.innerHeight||0);document.getElementById("game").width=t,document.getElementById("game").height=i;var e=t+"px;",h=i+"px;",s="width:"+e+"height:"+h;console.log("resume width:",document.getElementById("resume-game").style.width);var n="left:"+(Math.abs(t/2)-150)+"px;",o="left:"+(Math.abs(t/2)-150)+"px;";document.getElementById("wrapper").setAttribute("style",s),document.getElementById("title").setAttribute("style",n),document.getElementById("new-game").setAttribute("style",o),document.getElementById("resume-game").setAttribute("style",o),y.width=t,y.height=i,y.resize(),y.draw()}function l(){d()}t.prototype.update=function(){this.x+=this.vx,this.y+=this.vy},t.prototype.draw=function(t){var i=this.x+this.width/2,e=this.y+this.height/2,h=this.width/2;t.beginPath(),t.arc(i,e,h,0,2*Math.PI,!1),t.closePath(),t.fill()},t.prototype.getMidX=function(){return this.halfWidth+this.x},t.prototype.getMidY=function(){return this.halfHeight+this.y},t.prototype.getTop=function(){return this.y},t.prototype.getBottom=function(){return this.y+this.height},t.prototype.getLeft=function(){return this.x},t.prototype.getRight=function(){return this.x+this.width};var r=.004;i.prototype.collideRect=function(t,i){var e=t.getLeft(),h=t.getTop(),s=t.getRight(),n=t.getBottom(),o=i.getLeft(),a=i.getTop(),d=i.getRight(),l=i.getBottom();return!(a>n||h>l||o>s||e>d)},i.prototype.resolveElastic=function(t,i){var e=t.getMidX(),h=t.getMidY(),s=i.getMidX(),n=i.getMidY(),o=(s-e)/i.halfWidth,a=(n-h)/i.halfHeight,d=Math.abs(o),l=Math.abs(a);Math.abs(d-l)<.25?(0>o?t.x=i.getRight():t.x=i.getLeft()-t.width,0>a?t.y=i.getBottom():t.y=i.getTop()-t.height,Math.random()<.5?(t.vx=-t.vx*i.restitution,Math.abs(t.vx)<r&&(t.vx=0)):(t.vy=-t.vy*i.restitution,Math.abs(t.vy)<r&&(t.vy=0))):d>l?(0>o?t.x=i.getRight():t.x=i.getLeft()-t.width,t.vx=-t.vx*i.restitution,Math.abs(t.vx)<r&&(t.vx=0)):(0>a?t.y=i.getBottom():t.y=i.getTop()-t.height,t.vy=-t.vy*i.restitution,Math.abs(t.vy)<r&&(t.vy=0))},e.prototype.isPressed=function(t){return!!this.pressedKeys[t]},e.prototype.addKeyPressListener=function(t,i){document.addEventListener("keypress",function(e){e.charCode===t&&i(e)})},h.prototype.resize=function(t){this.x=t},h.prototype.draw=function(t){t.fillRect(this.x,this.y,this.width,this.height)},h.prototype.getMidX=function(){return this.halfWidth+this.x},h.prototype.getMidY=function(){return this.halfHeight+this.y},h.prototype.getTop=function(){return this.y},h.prototype.getBottom=function(){return this.y+this.height},h.prototype.getLeft=function(){return this.x},h.prototype.getRight=function(){return this.x+this.width},n.prototype.draw=function(t){t.fillText(this.value,this.x,this.y),t.font="30px Verdana"},n.prototype.resize=function(t){this.x=t};var u=112,c=2,p=4;o.prototype.resetGame=function(){this.p1.score=0,this.p2.score=0,this.p1.y=this.height/2-this.p1.height/2,this.p2.y=this.height/2-this.p2.height/2,this.ball.x=this.width/2,this.ball.y=this.height/2,this.ball.vy=Math.floor(Math.random()*c-p),this.ball.vx=c-Math.abs(this.ball.vy)},o.prototype.showMenu=function(){var t=document.getElementById("menu");this.paused?t.style.visibility="hidden":t.style.visibility="visible"},o.prototype.draw=function(){this.context.clearRect(0,0,this.width,this.height),this.context.fillRect(this.width/2,0,2,this.height),this.ball.draw(this.context),this.p1.draw(this.context),this.p2.draw(this.context),this.display1.draw(this.context),this.display2.draw(this.context)},o.prototype.resize=function(){var t=document.getElementById("game");this.context=t.getContext("2d"),this.context.fillStyle="white",this.display1.resize(this.width/4),this.display2.resize(3*this.width/4),this.p2.resize(this.width-5-10),this.p2.draw(this.context)},o.prototype.inputs=function(){this.paused||(this.display1.value=this.p1.score,this.display2.value=this.p2.score,this.keys.isPressed(83)?this.p1.y=Math.min(this.height-this.p1.height,this.p1.y+4):this.keys.isPressed(87)&&(this.p1.y=Math.max(0,this.p1.y-4)),this.keys.isPressed(40)?this.p2.y=Math.min(this.height-this.p2.height,this.p2.y+4):this.keys.isPressed(38)&&(this.p2.y=Math.max(0,this.p2.y-4)))},o.prototype.update=function(){this.paused||(this.ball.update(),this.collisions.collideRect(this.ball,this.p2)&&this.collisions.resolveElastic(this.ball,this.p2),this.collisions.collideRect(this.ball,this.p1)&&this.collisions.resolveElastic(this.ball,this.p1),(this.ball.vy<0&&this.ball.y<0||this.ball.vy>0&&this.ball.y+this.ball.height>this.height)&&(this.ball.vy=-this.ball.vy),this.ball.x>=this.width?this.score(this.p1):this.ball.x+this.ball.width<=0&&this.score(this.p2))},o.prototype.score=function(t){t.score++;var i=t==this.p1?0:1;this.ball.x=this.width/2,this.ball.y=t.y+t.height/2,this.ball.vy=Math.floor(Math.random()*c-p),this.ball.vx=c-Math.abs(this.ball.vy),1==i&&(this.ball.vx*=-1)};var y=new o,g=null;document.getElementById("resume-game").disabled=!0,document.getElementById("resume-game").onclick=function(){y.showMenu(),y.paused=!1},document.getElementById("new-game").onclick=function(){document.getElementById("resume-game").disabled=!1,y.resetGame(),y.showMenu(),y.paused=!1},g=window.requestAnimationFrame(a),d(),window.addEventListener("orientationchange",l),window.addEventListener("resize",function(){d()},!0)}();
//# sourceMappingURL=pong.js.map