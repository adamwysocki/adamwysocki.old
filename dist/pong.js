!function(){"use strict";function t(){this.x=0,this.y=0,this.vx=0,this.vy=0,this.ax=1,this.ay=1,this.width=14,this.height=14,this.halfHeight=this.height/2,this.halfWidth=this.width/2,this.radius=6,this.restitution=2}function i(){}function h(){this.pressedKeys=[],this.keydown=function(t){this.pressedKeys[t.keyCode]=!0},this.keyup=function(t){this.pressedKeys[t.keyCode]=!1},document.addEventListener("keydown",this.keydown.bind(this)),document.addEventListener("keyup",this.keyup.bind(this))}function e(t,i){this.x=t,this.y=i,this.width=10,this.height=80,this.score=0,this.halfWidth=this.width/2,this.halfHeight=this.height/2,this.restitution=1.1}function s(t){this.touches=[],this.touchMoveListener=function(t){},t.addEventListener("touchstart",function(t){t.preventDefault();for(var i=0;i<t.changedTouches.length;i++){var h=t.changedTouches[i];this.touches[h.identifier]={x:h.clientX,y:h.clientY}}}.bind(this)),t.addEventListener("touchmove",function(t){t.preventDefault();for(var i=0;i<t.changedTouches.length;i++){var h=t.changedTouches[i],e=this.touches[h.identifier];this.touches[h.identifier]={x:h.clientX,y:h.clientY};var s={x:h.clientX-e.x,y:h.clientY-e.y};this.touchMoveListener({x:h.clientX,y:h.clientY,offset:s})}}.bind(this)),t.addEventListener("touchend",function(t){t.preventDefault();for(var i=0;i<t.changedTouches.length;i++)delete this.touches[t.changedTouches[i].identifier]}.bind(this))}function o(t,i){this.x=t,this.y=i,this.value=0}function n(){var n=document.getElementById("game");this.width=n.width,this.height=n.height,this.context=n.getContext("2d"),this.context.fillStyle="white",this.keys=new h,this.touches=new s(n),this.collisions=new i;var a=this;this.keys.addKeyPressListener(l,function(t){a.paused?a.paused=!1:a.paused=!0}),this.paused=!1,this.p1=new e(5,0),this.p1.y=this.height/2-this.p1.height/2,this.display1=new o(this.width/4,35),this.p2=new e(this.width-5-10,0),this.p2.y=this.height/2-this.p2.height/2,this.display2=new o(3*this.width/4,35),this.touches.touchMoveListener=function(t){t.x<a.width/2?t.offset.y<0?a.p1.y=Math.max(0,a.p1.y+t.offset.y):a.p1.y=Math.min(a.height-a.p1.height,a.p1.y+t.offset.y):t.x>a.width/2&&(t.offset.y<0?a.p2.y=Math.max(0,a.p2.y+t.offset.y):a.p2.y=Math.min(a.height-a.p2.height,a.p2.y+t.offset.y))},this.ball=new t,this.ball.x=this.width/2,this.ball.y=this.height/2,this.ball.vy=Math.floor(8*Math.random()-6),this.ball.vx=7-Math.abs(this.ball.vy)}function a(t){y=requestAnimationFrame(a),d.update(),d.inputs(),d.draw()}t.prototype.update=function(){this.x+=this.vx,this.y+=this.vy},t.prototype.draw=function(t){var i=this.x+this.width/2,h=this.y+this.height/2,e=this.width/2;t.beginPath(),t.arc(i,h,e,0,2*Math.PI,!1),t.closePath(),t.fill()},t.prototype.getMidX=function(){return this.halfWidth+this.x},t.prototype.getMidY=function(){return this.halfHeight+this.y},t.prototype.getTop=function(){return this.y},t.prototype.getBottom=function(){return this.y+this.height},t.prototype.getLeft=function(){return this.x},t.prototype.getRight=function(){return this.x+this.width};var r=.004;i.prototype.collideRect=function(t,i){var h=t.getLeft(),e=t.getTop(),s=t.getRight(),o=t.getBottom(),n=i.getLeft(),a=i.getTop(),r=i.getRight(),l=i.getBottom();return console.log("l1:",h,"t1:",e,"r1:",s,"b1:",o,"l2:",n,"t2:",a,"r2:",r,"b2:",l),!(a>o||e>l||n>s||h>r)},i.prototype.resolveElastic=function(t,i){var h=t.getMidX(),e=t.getMidY(),s=i.getMidX(),o=i.getMidY(),n=(s-h)/i.halfWidth,a=(o-e)/i.halfHeight,l=Math.abs(n),d=Math.abs(a);Math.abs(l-d)<.25?(0>n?t.x=i.getRight():t.x=i.getLeft()-t.width,0>a?t.y=i.getBottom():t.y=i.getTop()-t.height,Math.random()<.5?(t.vx=-t.vx*i.restitution,Math.abs(t.vx)<r&&(t.vx=0)):(t.vy=-t.vy*i.restitution,Math.abs(t.vy)<r&&(t.vy=0))):l>d?(0>n?t.x=i.getRight():t.x=i.getLeft()-t.width,t.vx=-t.vx*i.restitution,Math.abs(t.vx)<r&&(t.vx=0)):(0>a?t.y=i.getBottom():t.y=i.getTop()-t.height,t.vy=-t.vy*i.restitution,Math.abs(t.vy)<r&&(t.vy=0))},h.prototype.isPressed=function(t){return!!this.pressedKeys[t]},h.prototype.addKeyPressListener=function(t,i){document.addEventListener("keypress",function(h){h.keyCode==t&&i(h)})},e.prototype.draw=function(t){t.fillRect(this.x,this.y,this.width,this.height)},e.prototype.getMidX=function(){return this.halfWidth+this.x},e.prototype.getMidY=function(){return this.halfHeight+this.y},e.prototype.getTop=function(){return this.y},e.prototype.getBottom=function(){return this.y+this.height},e.prototype.getLeft=function(){return this.x},e.prototype.getRight=function(){return this.x+this.width},o.prototype.draw=function(t){t.fillText(this.value,this.x,this.y),t.font="30px Verdana"};var l=112;n.prototype.draw=function(){this.context.clearRect(0,0,this.width,this.height),this.context.fillRect(this.width/2,0,2,this.height),this.ball.draw(this.context),this.p1.draw(this.context),this.p2.draw(this.context),this.display1.draw(this.context),this.display2.draw(this.context)},n.prototype.inputs=function(){this.paused||(this.display1.value=this.p1.score,this.display2.value=this.p2.score,this.keys.isPressed(83)?this.p1.y=Math.min(this.height-this.p1.height,this.p1.y+4):this.keys.isPressed(87)&&(this.p1.y=Math.max(0,this.p1.y-4)),this.keys.isPressed(40)?this.p2.y=Math.min(this.height-this.p2.height,this.p2.y+4):this.keys.isPressed(38)&&(this.p2.y=Math.max(0,this.p2.y-4)))},n.prototype.update=function(){this.paused||(this.ball.update(),this.collisions.collideRect(this.ball,this.p2)&&this.collisions.resolveElastic(this.ball,this.p2),this.collisions.collideRect(this.ball,this.p1)&&this.collisions.resolveElastic(this.ball,this.p1),(this.ball.vy<0&&this.ball.y<0||this.ball.vy>0&&this.ball.y+this.ball.height>this.height)&&(this.ball.vy=-this.ball.vy),this.ball.x>=this.width?this.score(this.p1):this.ball.x+this.ball.width<=0&&this.score(this.p2))},n.prototype.score=function(t){t.score++;var i=t==this.p1?0:1;this.ball.x=this.width/2,this.ball.y=t.y+t.height/2,this.ball.vy=Math.floor(8*Math.random()-6),this.ball.vx=7-Math.abs(this.ball.vy),1==i&&(this.ball.vx*=-1)};var d=new n,y=null;y=window.requestAnimationFrame(a)}();
//# sourceMappingURL=pong.js.map